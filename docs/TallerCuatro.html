<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Estadística Descriptiva multivariada - Taller Cuatro</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Estadística Descriptiva multivariada</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Información grupo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TallerUno.html" rel="" target="">
 <span class="menu-text">Taller Uno</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TallerDos.html" rel="" target="">
 <span class="menu-text">Taller Dos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TallerTres.html" rel="" target="">
 <span class="menu-text">Taller Tres</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./TallerCuatro.html" rel="" target="" aria-current="page">
 <span class="menu-text">Taller Cuatro</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TallerQuinto.html" rel="" target="">
 <span class="menu-text">Taller Quinto</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#análisis-de-correspondencias-simples-acs" id="toc-análisis-de-correspondencias-simples-acs" class="nav-link active" data-scroll-target="#análisis-de-correspondencias-simples-acs">Análisis de correspondencias simples (ACS)</a>
  <ul class="collapse">
  <li><a href="#punto-1-y-3" id="toc-punto-1-y-3" class="nav-link" data-scroll-target="#punto-1-y-3">Punto 1 y 3</a></li>
  <li><a href="#punto-2" id="toc-punto-2" class="nav-link" data-scroll-target="#punto-2">Punto 2</a>
  <ul class="collapse">
  <li><a href="#tabla-de-varianza-y-valores-propios" id="toc-tabla-de-varianza-y-valores-propios" class="nav-link" data-scroll-target="#tabla-de-varianza-y-valores-propios">Tabla de varianza y valores propios</a></li>
  <li><a href="#tabla-de-coordenadas-de-las-filas" id="toc-tabla-de-coordenadas-de-las-filas" class="nav-link" data-scroll-target="#tabla-de-coordenadas-de-las-filas">Tabla de coordenadas de las filas</a></li>
  <li><a href="#tabla-de-cosenos-de-las-filas" id="toc-tabla-de-cosenos-de-las-filas" class="nav-link" data-scroll-target="#tabla-de-cosenos-de-las-filas">Tabla de cosenos de las filas</a></li>
  <li><a href="#tabla-de-contribuciones-de-las-filas" id="toc-tabla-de-contribuciones-de-las-filas" class="nav-link" data-scroll-target="#tabla-de-contribuciones-de-las-filas">Tabla de contribuciones de las filas</a></li>
  <li><a href="#tabla-de-coordenadas-de-las-columnas" id="toc-tabla-de-coordenadas-de-las-columnas" class="nav-link" data-scroll-target="#tabla-de-coordenadas-de-las-columnas">Tabla de coordenadas de las columnas</a></li>
  <li><a href="#tabla-de-cosenos-de-las-columnas" id="toc-tabla-de-cosenos-de-las-columnas" class="nav-link" data-scroll-target="#tabla-de-cosenos-de-las-columnas">Tabla de cosenos de las columnas</a></li>
  <li><a href="#tabla-de-contribuciones-de-las-columnas" id="toc-tabla-de-contribuciones-de-las-columnas" class="nav-link" data-scroll-target="#tabla-de-contribuciones-de-las-columnas">Tabla de contribuciones de las columnas</a></li>
  <li><a href="#gráfico" id="toc-gráfico" class="nav-link" data-scroll-target="#gráfico">Gráfico</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#punto-4" id="toc-punto-4" class="nav-link" data-scroll-target="#punto-4">Punto 4</a>
  <ul class="collapse">
  <li><a href="#seleccionar-el-subconjunto-de-datos" id="toc-seleccionar-el-subconjunto-de-datos" class="nav-link" data-scroll-target="#seleccionar-el-subconjunto-de-datos">Seleccionar el subconjunto de datos</a></li>
  <li><a href="#crear-la-tabla-de-contingencia" id="toc-crear-la-tabla-de-contingencia" class="nav-link" data-scroll-target="#crear-la-tabla-de-contingencia">Crear la tabla de contingencia</a></li>
  </ul></li>
  <li><a href="#punto-5" id="toc-punto-5" class="nav-link" data-scroll-target="#punto-5">Punto 5</a></li>
  <li><a href="#punto-6" id="toc-punto-6" class="nav-link" data-scroll-target="#punto-6">Punto 6</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller Cuatro</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="análisis-de-correspondencias-simples-acs" class="level1">
<h1>Análisis de correspondencias simples (ACS)</h1>
<section id="punto-1-y-3" class="level2">
<h2 class="anchored" data-anchor-id="punto-1-y-3">Punto 1 y 3</h2>
<p>Con la metodología del ejemplo 1.8.1 hacer un ACS para la tabla de contingencias p17b×p21 con las preguntas“p17 b”(en las filas) sobre la facilidad para cumplir la ley y la preferencia por hacer acuerdos p21. Identificar patrones o tendencias si los hay y comentar los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df_mexico <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ciudad2 <span class="sc">==</span> <span class="st">"Mexico DF"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>tabla_mexico <span class="ot">&lt;-</span> <span class="fu">table</span>(df_mexico<span class="sc">$</span>p17_b, df_mexico<span class="sc">$</span>p21, <span class="at">useNA =</span> <span class="st">"ifany"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>tabla_con_totales <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(tabla_mexico)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_con_totales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                
                 p21_HACACU=1_n p21_HACACU=2_cn p21_HACACU=3_cs p21_HACACU=4_s
  p17b_FACL=1_n              13              16              21             17
  p17b_FACL=2_cn             25              73              96             47
  p17b_FACL=3_cs             89             261             494            324
  p17b_FACL=4_s             100             182             356            361
  &lt;NA&gt;                        3               2               3              0
  Sum                       230             534             970            749
                
                 &lt;NA&gt;  Sum
  p17b_FACL=1_n     0   67
  p17b_FACL=2_cn    3  244
  p17b_FACL=3_cs    9 1177
  p17b_FACL=4_s     5 1004
  &lt;NA&gt;              0    8
  Sum              17 2500</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tabla de perfiles fila </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>perfilesF <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(tabla_mexico)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>perf_fil <span class="ot">&lt;-</span> <span class="fu">cbind</span>(perfilesF, <span class="at">TotFil =</span> <span class="fu">rowSums</span>(tabla_mexico))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>perfilas <span class="ot">&lt;-</span> <span class="fu">round</span>(perf_fil <span class="sc">/</span> perf_fil<span class="sc">$</span>TotFil, <span class="dv">2</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(perfilas)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Para Markdown</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(perfilas, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">caption =</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tabla de Perfiles Fila: p17_b vs p21"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Tabla de Perfiles Fila: p17_b vs p21</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p21_HACACU=1_n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p21_HACACU=2_cn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p21_HACACU=3_cs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p21_HACACU=4_s</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NA</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TotFil</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p17b_FACL.1_n</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">p17b_FACL.2_cn</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p17b_FACL.3_cs</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">p17b_FACL.4_s</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA.</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>perfilas_long <span class="ot">&lt;-</span> perfilas <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>TotFil) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p17_b =</span> <span class="fu">rownames</span>(perfilas)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>p17_b, <span class="at">names_to =</span> <span class="st">"p17"</span>, <span class="at">values_to =</span> <span class="st">"Proporcion"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(perfilas_long, <span class="fu">aes</span>(<span class="at">x=</span>p17, <span class="at">y =</span> Proporcion, <span class="at">fill =</span> p17)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Proporcion, <span class="dv">2</span>)), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>p17_b, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span>  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Perfiles Fila: p17_b vs p21 (Solo México DF)"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporción"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Categoría p21"</span>) <span class="sc">+</span>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span>  </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tabla de perfiles COLUMNA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>perfilesC <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(tabla_mexico)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>TotCol <span class="ot">&lt;-</span> <span class="fu">colSums</span>(perfilesC)  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>perf_col <span class="ot">&lt;-</span> <span class="fu">rbind</span>(perfilesC, TotCol) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>perfilas_col <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sweep</span>(perfilesC, <span class="dv">2</span>, TotCol, <span class="at">FUN =</span> <span class="st">"/"</span>), <span class="dv">2</span>) </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>perfilas_col <span class="ot">&lt;-</span> <span class="fu">rbind</span>(perfilas_col, <span class="at">TotCol =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(TotCol)))  <span class="co"># Totales deben ser 1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(perfilas_col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               p21_HACACU=1_n p21_HACACU=2_cn p21_HACACU=3_cs p21_HACACU=4_s
p17b_FACL.1_n            0.06            0.03            0.02           0.02
p17b_FACL.2_cn           0.11            0.14            0.10           0.06
p17b_FACL.3_cs           0.39            0.49            0.51           0.43
p17b_FACL.4_s            0.43            0.34            0.37           0.48
NA.                      0.01            0.00            0.00           0.00
TotCol                   1.00            1.00            1.00           1.00
                 NA
p17b_FACL.1_n  0.00
p17b_FACL.2_cn 0.18
p17b_FACL.3_cs 0.53
p17b_FACL.4_s  0.29
NA.            0.00
TotCol         1.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GRÁFICO</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>perfilas_col_long <span class="ot">&lt;-</span> perfilas_col <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p21 =</span> <span class="fu">rownames</span>(perfilas_col)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>p21, <span class="at">names_to =</span> <span class="st">"p17_b"</span>, <span class="at">values_to =</span> <span class="st">"Proporcion"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(perfilas_col_long, <span class="fu">aes</span>(<span class="at">x =</span> p21, <span class="at">y =</span> Proporcion, <span class="at">fill =</span> p21)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Proporcion, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Agrega etiquetas</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>p17_b) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span>, <span class="st">"#7570b3"</span>, <span class="st">"#e7298a"</span>, <span class="st">"#66a61e"</span>, <span class="st">"#e6ab02"</span>)) <span class="sc">+</span> <span class="co"># Ahora hay 6 colores</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Perfiles Columna: p21 vs p17_b"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"p17_b"</span>,  <span class="co"># Cambia la etiqueta del eje X</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporción"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>preg17x21<span class="ot">&lt;-</span><span class="fu">CA</span>(<span class="fu">as.data.frame.matrix</span>(tabla_mexico), <span class="at">graph =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener coordenadas, contribuciones y cosenos cuadrados de las filas</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cor3R <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>row<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>orden_correcto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p17b_FACL=1_n"</span>, <span class="st">"p17b_FACL=2_cn"</span>, <span class="st">"p17b_FACL=3_cs"</span>, <span class="st">"p17b_FACL=4_s"</span>, <span class="st">"NA"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>con3R <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>row<span class="sc">$</span>contrib[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>) </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(con3R) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cont_Factor1"</span>, <span class="st">"Cont_Factor2"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(con3R) <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>cos3R <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>row<span class="sc">$</span>cos2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cos3R) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cos2_Factor1"</span>, <span class="st">"Cos2_Factor2"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cos3R) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir en formato tabla en la consola</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(cor3R, con3R, cos3R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Dim 1 Dim 2 Cont_Factor1 Cont_Factor2 Cos2_Factor1 Cos2_Factor2
p17b_FACL.1_n   0.04  0.38         0.24        41.84         0.01         0.98
p17b_FACL.2_cn  0.27  0.06        39.78         3.74         0.90         0.04
p17b_FACL.3_cs  0.06 -0.06        10.05        19.73         0.47         0.48
p17b_FACL.4_s  -0.14  0.03        46.65         2.83         0.96         0.03
NA.             0.42  0.95         3.28        31.86         0.15         0.76</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar los perfiles fila</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plotfil <span class="ot">&lt;-</span> <span class="fu">fviz_ca_row</span>(preg17x21, <span class="at">title =</span> <span class="st">"Análisis por filas: p17b vs p21"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>coord_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(preg17x21<span class="sc">$</span>row<span class="sc">$</span>coord)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>coord_df<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">rownames</span>(preg17x21<span class="sc">$</span>row<span class="sc">$</span>coord)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coord_df) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(coord_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reemplazar valores NA con la media de la dimensión respectiva</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>coord_df<span class="sc">$</span>Dim<span class="fl">.1</span>[<span class="fu">is.na</span>(coord_df<span class="sc">$</span>Dim<span class="fl">.1</span>)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(coord_df<span class="sc">$</span>Dim<span class="fl">.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>coord_df<span class="sc">$</span>Dim<span class="fl">.2</span>[<span class="fu">is.na</span>(coord_df<span class="sc">$</span>Dim<span class="fl">.2</span>)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(coord_df<span class="sc">$</span>Dim<span class="fl">.2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el orden correcto de los puntos (incluyendo NA)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el orden correcto, incluyendo "NA" como categoría válida</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>orden_correcto <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p17b_FACL=1_n"</span>, <span class="st">"p17b_FACL=2_cn"</span>, <span class="st">"p17b_FACL=3_cs"</span>, <span class="st">"p17b_FACL=4_s"</span>, <span class="st">"NA"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar y ordenar los puntos en la secuencia deseada</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>puntos_a_unir <span class="ot">&lt;-</span> coord_df[coord_df<span class="sc">$</span>labels <span class="sc">%in%</span> orden_correcto, ]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegurar que los puntos están en el orden correcto</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>puntos_a_unir <span class="ot">&lt;-</span> puntos_a_unir[<span class="fu">match</span>(orden_correcto, puntos_a_unir<span class="sc">$</span>labels), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar con la línea roja punteada</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plotfil <span class="sc">+</span> <span class="fu">geom_path</span>(<span class="at">data =</span> puntos_a_unir, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing missing values or values outside the scale range
(`geom_path()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener coordenadas, contribuciones y cosenos cuadrados de las COLUMNAS</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>cor_col <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>con_col <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>contrib[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cos_col <span class="ot">&lt;-</span> <span class="fu">round</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>cos2[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cor_col) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Coord_Factor1"</span>, <span class="st">"Coord_Factor2"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(con_col) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Contr_Factor1"</span>, <span class="st">"Contr_Factor2"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cos_col) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cos2_Factor1"</span>, <span class="st">"Cos2_Factor2"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>tabla_col <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cor_col, con_col, cos_col)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabla_col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Coord_Factor1 Coord_Factor2 Contr_Factor1 Contr_Factor2
p21_HACACU=1_n          -0.01          0.29          0.07         83.02
p21_HACACU=2_cn          0.16          0.01         29.81          0.49
p21_HACACU=3_cs          0.06         -0.05          7.01         12.82
p21_HACACU=4_s          -0.19         -0.02         59.94          1.85
&lt;NA&gt;                     0.28         -0.16          3.17          1.82
                Cos2_Factor1 Cos2_Factor2
p21_HACACU=1_n          0.00         0.99
p21_HACACU=2_cn         0.93         0.01
p21_HACACU=3_cs         0.44         0.42
p21_HACACU=4_s          0.98         0.02
&lt;NA&gt;                    0.62         0.19</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>filas_validas <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">rownames</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord)) <span class="sc">&amp;</span> <span class="fu">rownames</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord) <span class="sc">!=</span> <span class="st">"SinNombre"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar el filtro SOLO si las dimensiones coinciden</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(filas_validas) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord) <span class="sc">==</span> <span class="fu">nrow</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>contrib) <span class="sc">&amp;&amp;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord) <span class="sc">==</span> <span class="fu">nrow</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>cos2)) {</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord <span class="ot">&lt;-</span> preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord[filas_validas, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  preg17x21<span class="sc">$</span>col<span class="sc">$</span>contrib <span class="ot">&lt;-</span> preg17x21<span class="sc">$</span>col<span class="sc">$</span>contrib[filas_validas, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  preg17x21<span class="sc">$</span>col<span class="sc">$</span>cos2 <span class="ot">&lt;-</span> preg17x21<span class="sc">$</span>col<span class="sc">$</span>cos2[filas_validas, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Volver a generar la gráfica asegurando que el objeto se crea correctamente</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plotcol <span class="ot">&lt;-</span> <span class="fu">fviz_ca_col</span>(preg17x21, <span class="at">title =</span> <span class="st">"Análisis por columnas: p17b vs p21"</span>, <span class="at">label =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer coordenadas de los puntos de las columnas</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>coord_col_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>coord_col_df<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">rownames</span>(preg17x21<span class="sc">$</span>col<span class="sc">$</span>coord)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Renombrar columnas para evitar problemas con espacios</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coord_col_df) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(coord_col_df))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar para eliminar filas con NA en las coordenadas o en los nombres</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>coord_col_df <span class="ot">&lt;-</span> coord_col_df[<span class="fu">complete.cases</span>(coord_col_df[, <span class="fu">c</span>(<span class="st">"Dim.1"</span>, <span class="st">"Dim.2"</span>)]), ]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>coord_col_df <span class="ot">&lt;-</span> coord_col_df[<span class="sc">!</span>coord_col_df<span class="sc">$</span>labels <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"NA"</span>, <span class="st">"N.A"</span>), ]</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el orden correcto de los puntos</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>orden_correcto_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"p21_HACACU=1_n"</span>, <span class="st">"p21_HACACU=2_cn"</span>, <span class="st">"p21_HACACU=3_cs"</span>, <span class="st">"p21_HACACU=4_s"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar y ordenar los puntos en la secuencia deseada</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>puntos_col_unir <span class="ot">&lt;-</span> coord_col_df[coord_col_df<span class="sc">$</span>labels <span class="sc">%in%</span> orden_correcto_col, ]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>puntos_col_unir <span class="ot">&lt;-</span> puntos_col_unir[<span class="fu">match</span>(orden_correcto_col, puntos_col_unir<span class="sc">$</span>labels), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar con nombres en azul y línea punteada roja</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plotcol <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> coord_col_df, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">label =</span> labels), </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Nombres en azul sin sobreposición</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> puntos_col_unir, <span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Línea roja punteada</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(coord_col_df<span class="sc">$</span>Dim<span class="fl">.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(coord_col_df<span class="sc">$</span>Dim<span class="fl">.2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Relaciones entre filas y columnas</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías necesarias</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(factoextra)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar biplot de correspondencias entre las modalidades de ambas preguntas</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>biplot <span class="ot">&lt;-</span> <span class="fu">fviz_ca_biplot</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  preg17x21,  <span class="co"># Reemplaza con el objeto correcto de tu análisis</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Relaciones simultáneas entre las modalidades de p17b y p21"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"all"</span>,  <span class="co"># Etiquetas para filas y columnas</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.row =</span> <span class="st">"blue"</span>,  <span class="co"># Filas en azul</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.col =</span> <span class="st">"red"</span>,   <span class="co"># Columnas en rojo</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>       <span class="co"># Evita superposición de etiquetas</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar límites del eje X si es necesario</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>xlim_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar límites y mostrar el gráfico</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>biplot <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> xlim_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="punto-2" class="level2">
<h2 class="anchored" data-anchor-id="punto-2">Punto 2</h2>
<p>Construir la tabla de contingencias <em>p17_b</em>×<em>ciudad</em> excluyendo la ciudad que le correspondió al grupo y las ciudades de Asunción y Montevideo. Yuxtaponerla a la tabla <em>p17_b</em> × <em>p21</em> del ejercicio 1 y utilizarla como variable suplementaria para averiguar si se puede identificar algún patrón o tendencia en la facilidad para cumplir la ley en las ciudades suplementarias con respecto a las tendencias de la ciudad que le correspondió al grupo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Encuestas)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">"select ciudad2, p17_b, p21</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="st">                            from Encuestas</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">                            where ciudad2 in ('Quito', 'Belo Horizonte', 'Caracas', 'La Paz', 'Bogota', 'Medellin', 'Monterrey')"</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>TablaPreguntas <span class="ot">&lt;-</span> <span class="fu">table</span>(Encuestas<span class="sc">$</span>p17_b, Encuestas<span class="sc">$</span>p21)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>TablaCiudades <span class="ot">&lt;-</span> <span class="fu">table</span>(Encuestas<span class="sc">$</span>ciudad2, Encuestas<span class="sc">$</span>p21)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>TablaContingencia <span class="ot">&lt;-</span> <span class="fu">rbind</span>(TablaPreguntas, TablaCiudades)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(TablaContingencia) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"17b-Nunca"</span>, <span class="st">"17b-Casi Nunca"</span>, <span class="st">"17b-Casi siempre"</span>, <span class="st">"17b-Siempre"</span>, <span class="st">"Belo Horizonte"</span>, <span class="st">"Bogota"</span>, <span class="st">"Caracas"</span>, <span class="st">"La Paz"</span>, <span class="st">"Medellin"</span>, <span class="st">"Monterrey"</span>, <span class="st">"Quito"</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TablaContingencia) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"21-Nunca"</span>, <span class="st">"21-Casi Nunca"</span>, <span class="st">"21-Casi siempre"</span>, <span class="st">"21-Siempre"</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>TablaContingencia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 21-Nunca 21-Casi Nunca 21-Casi siempre 21-Siempre
17b-Nunca              74            67             149        107
17b-Casi Nunca        265           181             610        343
17b-Casi siempre      910           651            2838       1603
17b-Siempre          1169           759            2507       2483
Belo Horizonte        202           188             481        507
Bogota                502           344            1141       1431
Caracas               465           274             937        424
La Paz                519           161             957        421
Medellin              311           128             956        820
Monterrey             363           300            1067        355
Quito                  87           287             618        602</code></pre>
</div>
</div>
<section id="tabla-de-varianza-y-valores-propios" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-varianza-y-valores-propios">Tabla de varianza y valores propios</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ACSCiudades <span class="ot">&lt;-</span> <span class="fu">CA</span>(TablaContingencia, <span class="at">graph =</span> F, <span class="at">row.sup =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">11</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>eig,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">eigenvalue</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">percentage of variance</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">cumulative percentage of variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dim 1</td>
<td style="text-align: center;">0.0137</td>
<td style="text-align: center;">85.0763</td>
<td style="text-align: center;">85.0763</td>
</tr>
<tr class="even">
<td style="text-align: left;">dim 2</td>
<td style="text-align: center;">0.0022</td>
<td style="text-align: center;">13.7721</td>
<td style="text-align: center;">98.8484</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dim 3</td>
<td style="text-align: center;">0.0002</td>
<td style="text-align: center;">1.1516</td>
<td style="text-align: center;">100.0000</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-coordenadas-de-las-filas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-coordenadas-de-las-filas">Tabla de coordenadas de las filas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>row<span class="sc">$</span>coord,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17b-Nunca</td>
<td style="text-align: center;">-0.0074</td>
<td style="text-align: center;">0.1891</td>
<td style="text-align: center;">0.0610</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Casi Nunca</td>
<td style="text-align: center;">-0.0989</td>
<td style="text-align: center;">0.0985</td>
<td style="text-align: center;">-0.0288</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17b-Casi siempre</td>
<td style="text-align: center;">-0.1182</td>
<td style="text-align: center;">-0.0279</td>
<td style="text-align: center;">0.0040</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Siempre</td>
<td style="text-align: center;">0.1230</td>
<td style="text-align: center;">-0.0066</td>
<td style="text-align: center;">-0.0011</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-cosenos-de-las-filas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-cosenos-de-las-filas">Tabla de cosenos de las filas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>row<span class="sc">$</span>cos2,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17b-Nunca</td>
<td style="text-align: center;">0.0014</td>
<td style="text-align: center;">0.9046</td>
<td style="text-align: center;">0.0940</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Casi Nunca</td>
<td style="text-align: center;">0.4818</td>
<td style="text-align: center;">0.4775</td>
<td style="text-align: center;">0.0407</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17b-Casi siempre</td>
<td style="text-align: center;">0.9463</td>
<td style="text-align: center;">0.0527</td>
<td style="text-align: center;">0.0011</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Siempre</td>
<td style="text-align: center;">0.9971</td>
<td style="text-align: center;">0.0029</td>
<td style="text-align: center;">0.0001</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-contribuciones-de-las-filas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-contribuciones-de-las-filas">Tabla de contribuciones de las filas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>row<span class="sc">$</span>contrib,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17b-Nunca</td>
<td style="text-align: center;">0.0107</td>
<td style="text-align: center;">43.3775</td>
<td style="text-align: center;">53.9140</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Casi Nunca</td>
<td style="text-align: center;">6.7717</td>
<td style="text-align: center;">41.4523</td>
<td style="text-align: center;">42.2693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17b-Casi siempre</td>
<td style="text-align: center;">41.4720</td>
<td style="text-align: center;">14.2558</td>
<td style="text-align: center;">3.4866</td>
</tr>
<tr class="even">
<td style="text-align: left;">17b-Siempre</td>
<td style="text-align: center;">51.7456</td>
<td style="text-align: center;">0.9143</td>
<td style="text-align: center;">0.3301</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-coordenadas-de-las-columnas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-coordenadas-de-las-columnas">Tabla de coordenadas de las columnas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>col<span class="sc">$</span>coord,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21-Nunca</td>
<td style="text-align: center;">0.0333</td>
<td style="text-align: center;">0.0616</td>
<td style="text-align: center;">-0.0248</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Casi Nunca</td>
<td style="text-align: center;">-0.0103</td>
<td style="text-align: center;">0.0940</td>
<td style="text-align: center;">0.0269</td>
</tr>
<tr class="odd">
<td style="text-align: left;">21-Casi siempre</td>
<td style="text-align: center;">-0.1238</td>
<td style="text-align: center;">-0.0256</td>
<td style="text-align: center;">-0.0001</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Siempre</td>
<td style="text-align: center;">0.1526</td>
<td style="text-align: center;">-0.0328</td>
<td style="text-align: center;">0.0035</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-cosenos-de-las-columnas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-cosenos-de-las-columnas">Tabla de cosenos de las columnas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>col<span class="sc">$</span>cos2,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21-Nunca</td>
<td style="text-align: center;">0.2008</td>
<td style="text-align: center;">0.6882</td>
<td style="text-align: center;">0.1110</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Casi Nunca</td>
<td style="text-align: center;">0.0110</td>
<td style="text-align: center;">0.9141</td>
<td style="text-align: center;">0.0748</td>
</tr>
<tr class="odd">
<td style="text-align: left;">21-Casi siempre</td>
<td style="text-align: center;">0.9590</td>
<td style="text-align: center;">0.0410</td>
<td style="text-align: center;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Siempre</td>
<td style="text-align: center;">0.9554</td>
<td style="text-align: center;">0.0441</td>
<td style="text-align: center;">0.0005</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="tabla-de-contribuciones-de-las-columnas" class="level3">
<h3 class="anchored" data-anchor-id="tabla-de-contribuciones-de-las-columnas">Tabla de contribuciones de las columnas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">round</span>(ACSCiudades<span class="sc">$</span>col<span class="sc">$</span>contrib,<span class="dv">4</span>), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">booktabs =</span> T, <span class="at">align =</span> <span class="st">'c'</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Factor 1"</span>, <span class="st">"Factor 2"</span>, <span class="st">"Factor 3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Factor 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21-Nunca</td>
<td style="text-align: center;">1.3264</td>
<td style="text-align: center;">28.0832</td>
<td style="text-align: center;">54.1593</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Casi Nunca</td>
<td style="text-align: center;">0.0876</td>
<td style="text-align: center;">44.7949</td>
<td style="text-align: center;">43.8508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">21-Casi siempre</td>
<td style="text-align: center;">46.2969</td>
<td style="text-align: center;">12.2232</td>
<td style="text-align: center;">0.0012</td>
</tr>
<tr class="even">
<td style="text-align: left;">21-Siempre</td>
<td style="text-align: center;">52.2891</td>
<td style="text-align: center;">14.8986</td>
<td style="text-align: center;">1.9887</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="gráfico" class="level3">
<h3 class="anchored" data-anchor-id="gráfico">Gráfico</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(ACSCiudades, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">col.row =</span> <span class="st">"red"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">col.col =</span> <span class="st">"blue3"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">col.row.sup =</span> <span class="st">"purple"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"ACS con ciudades suplementarias"</span>, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Factor 1 (85.08%)"</span>, </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"Factor 2 (13.77%)"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="punto-4" class="level1">
<h1>Punto 4</h1>
<section id="seleccionar-el-subconjunto-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="seleccionar-el-subconjunto-de-datos">Seleccionar el subconjunto de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ECC_completa_19426<span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>Mexico <span class="ot">&lt;-</span> ECC_completa_19426[<span class="dv">1</span><span class="sc">:</span><span class="dv">2500</span>,]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>p17xp21 <span class="ot">&lt;-</span> <span class="fu">table</span>(Mexico<span class="sc">$</span>p17_b, Mexico<span class="sc">$</span>p21)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>preg17x21 <span class="ot">&lt;-</span><span class="fu">CA</span>(<span class="fu">as.data.frame.matrix</span>(p17xp21), <span class="at">graph =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="crear-la-tabla-de-contingencia" class="level3">
<h3 class="anchored" data-anchor-id="crear-la-tabla-de-contingencia">Crear la tabla de contingencia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Ciudades <span class="ot">&lt;-</span> <span class="fu">table</span>(ECC_completa_19426<span class="sc">$</span>ciudad2, ECC_completa_19426<span class="sc">$</span>p21)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Ciudadespreguntas <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p17xp21, Ciudades)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Ciudadespreguntas) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Siempre"</span>, <span class="st">"Casi siempre"</span>, <span class="st">"Nunca"</span>, <span class="st">"Casi nunca"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Ciudadespreguntas)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nunca"</span>, <span class="st">"Casi nunca"</span>, <span class="st">"Casi siempre"</span>, <span class="st">"Siempre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Ciudadespreguntas, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Preguntas activas con ciudades como variable suplementaria"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"prSuplementaria"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Preguntas activas con ciudades como variable suplementaria</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Siempre</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Casi siempre</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Nunca</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Casi nunca</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nunca</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Casi nunca</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Casi siempre</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">261</td>
<td style="text-align: right;">494</td>
<td style="text-align: right;">324</td>
</tr>
<tr class="even">
<td style="text-align: left;">Siempre</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">182</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">361</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asuncion</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">299</td>
<td style="text-align: right;">215</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belo Horizonte</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">481</td>
<td style="text-align: right;">507</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bogota</td>
<td style="text-align: right;">502</td>
<td style="text-align: right;">344</td>
<td style="text-align: right;">1141</td>
<td style="text-align: right;">1431</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caracas</td>
<td style="text-align: right;">465</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">937</td>
<td style="text-align: right;">424</td>
</tr>
<tr class="odd">
<td style="text-align: left;">La Paz</td>
<td style="text-align: right;">519</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">421</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medellin</td>
<td style="text-align: right;">311</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">956</td>
<td style="text-align: right;">820</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico DF</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">534</td>
<td style="text-align: right;">970</td>
<td style="text-align: right;">749</td>
</tr>
<tr class="even">
<td style="text-align: left;">Monterrey</td>
<td style="text-align: right;">363</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">1067</td>
<td style="text-align: right;">355</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montevideo</td>
<td style="text-align: right;">216</td>
<td style="text-align: right;">248</td>
<td style="text-align: right;">516</td>
<td style="text-align: right;">290</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quito</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">287</td>
<td style="text-align: right;">618</td>
<td style="text-align: right;">602</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Como podemos evidenciar La Paz y Bogotá siempre hacen acuerdos, luego tenemos a Mexico DF y Bogota que casi siempre hacen acuerdos, seguimos con Bogotá y Monterrey que nunca hacen acuerdos por último, Bogotá y Medellin que casi nunca hacen acuerdos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>CiudadesIlustrativas <span class="ot">=</span> <span class="fu">CA</span>(Ciudadespreguntas, <span class="at">row.sup =</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">12</span><span class="sc">:</span><span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CiudadesIlustrativas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
CA(X = Ciudadespreguntas, row.sup = c(5:10, 12:14)) 

The chi square of independence between the two variables is equal to 56.86353 (p-value =  8.365455e-08 ).

Eigenvalues
                       Dim.1   Dim.2   Dim.3
Variance               0.008   0.003   0.000
% of var.             71.571  27.020   1.409
Cumulative % of var.  71.571  98.591 100.000

Rows
                 Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2  
Nunca          |     1.868 | -0.016  0.042  0.002 |  0.365 58.217  0.966 |
Casi nunca     |     3.670 | -0.254 38.073  0.851 |  0.100 15.633  0.132 |
Casi siempre   |     1.836 | -0.067 12.745  0.570 | -0.057 24.746  0.418 |
Siempre        |     4.094 |  0.141 49.138  0.985 |  0.015  1.370  0.010 |
Mexico DF      |     0.002 | -0.001  0.002  0.095 |  0.001  0.034  0.689 |
                Dim.3    ctr   cos2  
Nunca           0.067 37.292  0.032 |
Casi nunca     -0.035 37.591  0.017 |
Casi siempre    0.010 13.912  0.012 |
Siempre        -0.009 11.000  0.004 |
Mexico DF       0.001  0.205  0.217 |

Columns
                 Iner*1000    Dim.1    ctr   cos2    Dim.2    ctr   cos2  
Siempre        |     2.382 |  0.037  1.570  0.054 |  0.155 71.806  0.934 |
Casi siempre   |     2.870 | -0.111 32.115  0.918 |  0.028  5.419  0.059 |
Nunca          |     1.449 | -0.044  9.278  0.526 | -0.040 20.561  0.440 |
Casi nunca     |     4.767 |  0.124 57.037  0.982 | -0.015  2.214  0.014 |
                Dim.3    ctr   cos2  
Siempre         0.017 17.407  0.012 |
Casi siempre   -0.018 40.965  0.023 |
Nunca           0.011 31.092  0.035 |
Casi nunca     -0.008 10.536  0.004 |

Supplementary rows
                  Dim.1   cos2    Dim.2   cos2    Dim.3   cos2  
Asuncion       |  0.271  0.320 | -0.199  0.172 |  0.342  0.508 |
Belo Horizonte |  0.229  0.660 |  0.125  0.196 |  0.107  0.145 |
Bogota         |  0.350  0.837 |  0.105  0.075 |  0.113  0.088 |
Caracas        | -0.008  0.000 |  0.305  0.364 |  0.403  0.635 |
La Paz         |  0.063  0.010 |  0.350  0.299 |  0.533  0.691 |
Medellin       |  0.286  0.510 |  0.008  0.000 |  0.280  0.489 |
Monterrey      | -0.119  0.075 |  0.141  0.104 |  0.397  0.822 |
Montevideo     | -0.053  0.032 |  0.216  0.542 |  0.192  0.426 |
Quito          |  0.132  0.439 | -0.141  0.496 | -0.051  0.064 |</code></pre>
</div>
</div>
<p>Vemos como proyectamos las ciudades sobre los factores producidos por la tabla de contingencia de las preguntas actuar conforme a la ley y hacer acuerdos o tratos entre sí, donde tenemos a la ciudad de Mexico DF como la ciudad activa y las demás suplementarias, obsevemos como se repite el “Nunca” y el “Casi siempre” para hacer acuerdos o tratos entre sí, como los que se encuentran más cerca del centro, por otro lado, tenemos el “Casi siempre” y el “Siempre” para actuar conforme a la ley más cerca del centro.</p>
<p>La varianza en las dos primeras dimensiones avarcan aproximadamente el 98 porciento, por lo tanto por eso tomamos los dos primeros factores, en las filas (Actuar conforme a la ley) vemos como en el primer factor Casi nunca y Siempre son los valores más altos tanto en coordenadas, contribución y en los cosenos cuadrados.En el segundo factor nunca y casi nunca son los más “altos” en coordenadas, también nunca y casi siempre de contribuciones, por último, Nunca y Mexico DF en cosenos cuadrados.</p>
<p>Por otro lado, vemos con las columna (Hacer acuerdos o tratos entre sí) en el primer factor como Casi nunca y Casi siempre son los más “altos” en coordinadas, contribuciones y cosenos cuadrados.En el segundo factor Siempre y Nunca que también son las mejores en coordinadas, contribuciones y cosenos cuadrados.</p>
<p>Por último, veamos que las variables suplementarias de ciudades no tienen varizanza por ser suplementarias y no aportan, en el primer componente vemos a Bogotá y Medellin como los más altos y Caracas como el más bajo en coordenadas, mientras Bogotá y Belo Horizonte como más altos y Caracas nuevamente en cosenos cuadrados.En el segundo componente tenemos La Paz y Caracas como los más altos y Medellin como el más bajo en coordenadas, mientras Montevideo y Quito como más altos y Medellin nuevamente en cosenos cuadrados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>CiudadesIlustrativasa <span class="ot">&lt;-</span> <span class="fu">CA</span>(<span class="fu">as.data.frame.matrix</span>(Ciudadespreguntas))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="punto-5" class="level1">
<h1>Punto 5</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span>  <span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Encuestas)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">"select p30, ciudad2</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="st">                   from Encuestas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>TablaContingencia <span class="ot">&lt;-</span> <span class="fu">table</span>(Encuestas<span class="sc">$</span>p30, Encuestas<span class="sc">$</span>ciudad2)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>TablaContingencia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   
                    Asuncion Belo Horizonte Bogota Caracas La Paz Medellin
  p30_AP=1_menosseg      323            603   1665    1457    926      841
  p30_AP=2_igual         240            547   1398     524   1008     1031
  p30_AP=3_masseg         18            209    329      93    139      334
                   
                    Mexico DF Monterrey Montevideo Quito
  p30_AP=1_menosseg       929      1124        514   818
  p30_AP=2_igual         1299       858        664   597
  p30_AP=3_masseg         254       113         97   165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(TablaContingencia) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Menos segura"</span>, <span class="st">"Igual"</span>, <span class="st">"Más segura"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ACS <span class="ot">&lt;-</span> <span class="fu">CA</span>(TablaContingencia, <span class="at">graph =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">fviz_ca_biplot</span>(ACS, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.row =</span> <span class="st">"red"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.col =</span> <span class="st">"blue3"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"Seguridad Ciudadana: Perspectivas en diferentes ciudades"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)  </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Los habitantes de ciudades como Bogotá, Quito, Monterrey, Asunción y Caracas han reportado un aumento en la percepción de inseguridad, situando a estas ciudades en la categoría de “Menos seguras”. Por otro lado, en ciudades como Medellín y Bello Horizonte, la percepción predominante es que la seguridad ha mejorado, clasificándolas como “Más seguras”. Finalmente, en ciudades como Ciudad de México, Montevideo y La Paz, la percepción de seguridad se mantiene estable, indicando que, para sus habitantes, la situación “sigue igual”.</p>
</section>
<section id="punto-6" class="level1">
<h1>Punto 6</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Encuestas)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">"select p30, ciudad2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="st">                   from Encuestas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>TablaContingencia <span class="ot">&lt;-</span> <span class="fu">table</span>(Encuestas<span class="sc">$</span>p30, Encuestas<span class="sc">$</span>ciudad2)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>TablaContingencia</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   
                    Asuncion Belo Horizonte Bogota Caracas La Paz Medellin
  p30_AP=1_menosseg      323            603   1665    1457    926      841
  p30_AP=2_igual         240            547   1398     524   1008     1031
  p30_AP=3_masseg         18            209    329      93    139      334
                   
                    Mexico DF Monterrey Montevideo Quito
  p30_AP=1_menosseg       929      1124        514   818
  p30_AP=2_igual         1299       858        664   597
  p30_AP=3_masseg         254       113         97   165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(TablaContingencia) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Menos segura"</span>, <span class="st">"Igual"</span>, <span class="st">"Más segura"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"C:/Users/fabia/OneDrive - Universidad Nacional de Colombia/UNAL/Descriptiva multivariada/Talleres/Recopilación/Bases de datos/ECC_completa_19426.csv"</span>, <span class="at">comment.char=</span><span class="st">"#"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Encuestas)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>Encuestas <span class="ot">&lt;-</span> <span class="fu">sqldf</span>(<span class="st">"select p17_b, ciudad2</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="st">                   from Encuestas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>TablaP17 <span class="ot">&lt;-</span> <span class="fu">table</span>(Encuestas<span class="sc">$</span>p17_b, Encuestas<span class="sc">$</span>ciudad2)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>TablaP17</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                
                 Asuncion Belo Horizonte Bogota Caracas La Paz Medellin
  p17b_FACL=1_n         3             23     97      49     77       73
  p17b_FACL=2_cn       66             67    222     213    321      230
  p17b_FACL=3_cs      334            510    935     775    896      989
  p17b_FACL=4_s       179            779   2157    1032    754      922
                
                 Mexico DF Monterrey Montevideo Quito
  p17b_FACL=1_n         67        35          8    45
  p17b_FACL=2_cn       244       131         45   243
  p17b_FACL=3_cs      1177      1275        408   731
  p17b_FACL=4_s       1004       757        814   574</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(TablaP17) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nunca"</span>, <span class="st">"Casi nunca"</span>, <span class="st">"Casi siempre"</span>, <span class="st">"Siempre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>TablaContingenciaPreguntasCiudades <span class="ot">&lt;-</span> <span class="fu">rbind</span>(TablaContingencia, TablaP17)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>TablaContingenciaPreguntasCiudades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Asuncion Belo Horizonte Bogota Caracas La Paz Medellin Mexico DF
Menos segura      323            603   1665    1457    926      841       929
Igual             240            547   1398     524   1008     1031      1299
Más segura         18            209    329      93    139      334       254
Nunca               3             23     97      49     77       73        67
Casi nunca         66             67    222     213    321      230       244
Casi siempre      334            510    935     775    896      989      1177
Siempre           179            779   2157    1032    754      922      1004
             Monterrey Montevideo Quito
Menos segura      1124        514   818
Igual              858        664   597
Más segura         113         97   165
Nunca               35          8    45
Casi nunca         131         45   243
Casi siempre      1275        408   731
Siempre            757        814   574</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ACSp30p17 <span class="ot">&lt;-</span> <span class="fu">CA</span>(TablaContingenciaPreguntasCiudades, <span class="at">graph =</span> F, <span class="at">row.sup =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">fviz_ca_biplot</span>(ACSp30p17, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.row =</span> <span class="st">"red"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.col =</span> <span class="st">"black"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.row.sup=</span> <span class="st">"purple"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">"P17 Y P30"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">1</span>)  </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TallerCuatro_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>